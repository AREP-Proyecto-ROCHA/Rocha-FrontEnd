{"ast":null,"code":"import _classCallCheck from \"/home/martin/Escritorio/Rocha-FrontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/martin/Escritorio/Rocha-FrontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/martin/Escritorio/Rocha-FrontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/martin/Escritorio/Rocha-FrontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/martin/Escritorio/Rocha-FrontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/martin/Escritorio/Rocha-FrontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/martin/Escritorio/Rocha-FrontEnd/src/Login/Login.js\";\nimport React from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport Input from \"@material-ui/core/Input\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { Redirect } from \"react-router-dom\";\nimport axios from \"axios\";\nimport \"./Login.css\";\nimport logof from \"./../logof.jpg\";\nexport var Login =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Login, _React$Component);\n\n  function Login(props) {\n    var _this;\n\n    _classCallCheck(this, Login);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Login).call(this, props));\n    _this.handleSubmit = _this.handleSubmit.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.state = {\n      fireRedirect: false\n    };\n    console.log(\"Currently using API: \" + apiURL);\n    return _this;\n  }\n\n  _createClass(Login, [{\n    key: \"render\",\n    value: function render() {\n      if (this.state.fireRedirect === true) {\n        return React.createElement(Redirect, {\n          to: \"/app/map\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 28\n          },\n          __self: this\n        });\n      }\n\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 32\n        },\n        __self: this\n      }, React.createElement(CssBaseline, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 33\n        },\n        __self: this\n      }), React.createElement(\"main\", {\n        className: \"layout\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 34\n        },\n        __self: this\n      }, React.createElement(Paper, {\n        className: \"paper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 35\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: logof,\n        alt: \"logo\",\n        className: \"img\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 36\n        },\n        __self: this\n      }), React.createElement(Typography, {\n        variant: \"h5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 37\n        },\n        __self: this\n      }, \"Acceder\"), React.createElement(\"form\", {\n        className: \"form\",\n        onSubmit: this.handleSubmit,\n        name: \"login-form\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 38\n        },\n        __self: this\n      }, React.createElement(FormControl, {\n        margin: \"normal\",\n        required: true,\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 39\n        },\n        __self: this\n      }, React.createElement(InputLabel, {\n        htmlFor: \"email\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 40\n        },\n        __self: this\n      }, \"Direcci\\xF3n de correo\"), React.createElement(Input, {\n        id: \"email\",\n        name: \"email\",\n        autoComplete: \"email\",\n        autoFocus: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 41\n        },\n        __self: this\n      })), React.createElement(FormControl, {\n        margin: \"normal\",\n        required: true,\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 43\n        },\n        __self: this\n      }, React.createElement(InputLabel, {\n        htmlFor: \"password\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 44\n        },\n        __self: this\n      }, \"Contrase\\xF1a\"), React.createElement(Input, {\n        name: \"password\",\n        type: \"password\",\n        id: \"password\",\n        autoComplete: \"current-password\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45\n        },\n        __self: this\n      })), React.createElement(Button, {\n        type: \"submit\",\n        fullWidth: true,\n        variant: \"contained\",\n        color: \"primary\",\n        className: \"submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52\n        },\n        __self: this\n      }, \"Acceder\")), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }), React.createElement(\"a\", {\n        href: \"/register\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63\n        },\n        __self: this\n      }, \"Registrarse\"))));\n    }\n  }, {\n    key: \"handleSubmit\",\n    value: function handleSubmit(e) {\n      var _this2 = this;\n\n      e.preventDefault();\n      var useremail = document.getElementById(\"email\").value;\n      var password = document.getElementById(\"password\").value;\n      axios.post(apiURL + \"/accounts/login\", {\n        id: useremail,\n        password: password\n      }).then(function (response) {\n        localStorage.setItem(\"token\", response.data.accessToken);\n\n        _this2.createAxiosInstance(response.data.accessToken);\n\n        _this2.getBasicUserInfoAndRedirect(useremail);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    }\n  }, {\n    key: \"createAxiosInstance\",\n    value: function createAxiosInstance(token) {\n      axiosInstance = axios.create({\n        baseURL: apiURL,\n        timeout: 1000,\n        headers: {\n          \"Authorization\": \"Bearer \" + token\n        }\n      });\n    }\n  }, {\n    key: \"getBasicUserInfoAndRedirect\",\n    value: function getBasicUserInfoAndRedirect(mail) {\n      var _this3 = this;\n\n      axiosInstance.get(\"/users/private/\" + mail).then(function (response) {\n        localStorage.setItem(\"userName\", response.data.name + \" \" + response.data.lastName);\n        localStorage.setItem(\"userMail\", response.data.email);\n\n        _this3.setState({\n          fireRedirect: true\n        });\n      }).catch(function (error) {\n        console.log(error);\n      });\n    }\n  }]);\n\n  return Login;\n}(React.Component);\nvar apiURL = window.location.hostname === \"localhost\" ? \"http://localhost:8080\" : \"https://myuniapp-back.herokuapp.com\";\nvar axiosInstance;","map":{"version":3,"sources":["/home/martin/Escritorio/Rocha-FrontEnd/src/Login/Login.js"],"names":["React","Button","CssBaseline","FormControl","Input","InputLabel","Paper","Typography","Redirect","axios","logof","Login","props","handleSubmit","bind","state","fireRedirect","console","log","apiURL","e","preventDefault","useremail","document","getElementById","value","password","post","id","then","response","localStorage","setItem","data","accessToken","createAxiosInstance","getBasicUserInfoAndRedirect","catch","error","token","axiosInstance","create","baseURL","timeout","headers","mail","get","name","lastName","email","setState","Component","window","location","hostname"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport Input from \"@material-ui/core/Input\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { Redirect } from \"react-router-dom\";\nimport axios from \"axios\";\nimport \"./Login.css\";\nimport logof from \"./../logof.jpg\";\n\nexport class Login extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.handleSubmit = this.handleSubmit.bind(this);\n\n        this.state = {\n            fireRedirect : false\n        };\n        console.log(\"Currently using API: \" + apiURL);\n    }\n\n    render() {\n        if (this.state.fireRedirect === true) {\n            return (<Redirect to=\"/app/map\"/>);\n        }\n\n        return (\n            <React.Fragment>\n                <CssBaseline />\n                <main className=\"layout\">\n                    <Paper className=\"paper\">\n                        <img src={logof} alt=\"logo\" className=\"img\"/> \n                        <Typography variant=\"h5\">Acceder</Typography>\n                        <form className=\"form\" onSubmit={this.handleSubmit} name=\"login-form\">\n                            <FormControl margin=\"normal\" required fullWidth>\n                                <InputLabel htmlFor=\"email\">Dirección de correo</InputLabel>\n                                <Input id=\"email\" name=\"email\" autoComplete=\"email\" autoFocus />\n                            </FormControl>\n                            <FormControl margin=\"normal\" required fullWidth>\n                                <InputLabel htmlFor=\"password\">Contraseña</InputLabel>\n                                <Input\n                                    name=\"password\"\n                                    type=\"password\"\n                                    id=\"password\"\n                                    autoComplete=\"current-password\"\n                                />\n                            </FormControl>\n                            <Button\n                                type=\"submit\"\n                                fullWidth\n                                variant=\"contained\"\n                                color=\"primary\"\n                                className=\"submit\"\n                            >\n                                Acceder\n                            </Button>\n                        </form>\n                        <br></br>\n                        <a href=\"/register\">Registrarse</a>\n                    </Paper>\n                </main>\n            </React.Fragment>\n        );\n    }\n\n    handleSubmit(e) {\n        e.preventDefault();\n        var useremail = document.getElementById(\"email\").value;\n        var password = document.getElementById(\"password\").value;\n\n        axios.post(apiURL + \"/accounts/login\", {\n            id: useremail,\n            password\n        }).then((response) => {\n            localStorage.setItem(\"token\", response.data.accessToken);\n            this.createAxiosInstance(response.data.accessToken);\n            this.getBasicUserInfoAndRedirect(useremail);\n        }).catch((error) => {\n            console.log(error);\n        });\n    }\n\n    createAxiosInstance(token) {\n        axiosInstance = axios.create({\n            baseURL: apiURL,\n            timeout: 1000,\n            headers: {\"Authorization\": \"Bearer \" + token}\n        });\n    }\n\n    getBasicUserInfoAndRedirect(mail) {\n        axiosInstance.get(\"/users/private/\" + mail).then((response) => {\n            localStorage.setItem(\"userName\", response.data.name + \" \" + response.data.lastName);\n            localStorage.setItem(\"userMail\", response.data.email);\n            this.setState({\n                fireRedirect: true\n            });\n        }).catch((error) => {\n            console.log(error);\n        });\n    }\n}\n\nconst apiURL = ((window.location.hostname === \"localhost\") ? \"http://localhost:8080\" : \"https://myuniapp-back.herokuapp.com\");\nvar axiosInstance;"]},"metadata":{},"sourceType":"module"}